<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>CellarCount 2026 â€“ Rapporter & Print</title>
<style>
body{font-family:Arial;margin:20px;background:#f6f6f6}
table{border-collapse:collapse;width:100%;background:#fff}
th,td{border:1px solid #ccc;padding:6px}
th{background:#eee}
button{padding:6px;margin:6px}
.label{border:1px solid #000;padding:8px;margin:6px;width:260px;display:inline-block}
@media print {
  body * { visibility: hidden; }
  #labels, #labels * { visibility: visible; }
  #labels { position: absolute; left: 0; top: 0; }
}
</style>
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<h1>ğŸ· CellarCount 2026</h1>

<button onclick="printLabels()">ğŸ–¨ï¸ Print labels</button>
<button onclick="generatePDF()">ğŸ“„ PDF rapport</button>

<h2>Samlet lagervÃ¦rdi</h2>
<div id="total"></div>

<h2>Labels</h2>
<div id="labels"></div>

<script>
let wines = JSON.parse(localStorage.getItem("cellarcount2026")||"[]");

function render(){
 const d=document.getElementById("labels");
 d.innerHTML="";
 let sum=0;
 wines.forEach(w=>{
  sum += (w.qty||0)*(w.price||0);
  const box=document.createElement("div");
  box.className="label";
  box.innerHTML=`<strong>${w.name}</strong><br>
  ${w.type} â€“ ${w.country}<br>
  Reol ${w.reol} Â· Hylde ${w.hylde}<br>`;
  const c=document.createElement("canvas");
  QRCode.toCanvas(c,w.vinId);
  box.appendChild(c);
  d.appendChild(box);
 });
 document.getElementById("total").innerText =
  sum.toLocaleString("da-DK",{style:"currency",currency:"DKK"});
}

function printLabels(){ window.print(); }

function generatePDF(){
 const { jsPDF } = window.jspdf;
 const pdf = new jsPDF();
 let y=10;
 wines.forEach(w=>{
  pdf.text(`${w.name} â€“ ${w.qty} stk â€“ ${w.price} kr.`,10,y);
  y+=8;
  if(y>280){ pdf.addPage(); y=10; }
 });
 pdf.save("CellarCount_2026_Rapport.pdf");
}

render();
</script>
</body>
</html>
